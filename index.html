<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MBot-Controller</title>
    <link rel="icon" type="image/x-icon" href="./images/icons/icon.ico">
    <link rel="stylesheet" href="./css/main.css">
    <link rel="stylesheet" href="./css/controller.css">

    <!-- MBot2 Connection Skript -->
    <script src="./scripts/webApp-Connection.js"></script>
</head>
<body>
    <header>
        <h2 class="logo">Group 5</h2>
        <nav class="navigation">
            <div class="button-container-small">
                <button class="btnLogin-popup" id="phone-login">Login</button>
                <div class="icon-menu">&#9776;</div> <!-- Hamburger icon for mobile -->
            </div>
            <a href="start.html#home">Home</a>
            <a href="start.html#about">About</a>
            <a href="start.html#team">Team</a>
            <a href="start.html#log">Log</a>
            <a href="index.html#controller" onclick="getPossibleMBots()">Controller</a>
            <button  class="btnLogin-popup" id="one-login">Login</button>
        </nav>

        <!-- 3D Model Viewer -->
        <script type="module" src="./scripts/modelViewer.js"></script>
    </header>

    <div class="wrapper">
        <div class="form-box">
            <h2>Connect</h2>
            <span class="icon-close"><ion-icon name="close"></ion-icon></span>
            <form class="searchMBot" action="#">
                <div class="wrapper small">
                    <ul id="showPossibleMBots"></ul>
                    <div id="textForWhileSearchingMBot" class="info-text">
                        <p class="search_label">Searching</p>
                    </div>
                </div>
            </form>
            <div class="buttons-container">
                <button class="button" onclick="connectToMBot2()">Connect</button>
                <button class="button">Save</button>
            </div>
        </div>
    </div>

    <div class="main-controll-page">
        <div class="model3d">
            <h3>3D-Model:</h3>
            <model-viewer id ="mbot2Model" src="./model/mbot2_model.glb" alt="A 3D model" orientation="0 0 0"></model-viewer>
        </div>
        <div class="controlls">
            <div class="arrow-controlls">
                <h3 class="controllertext">Controller:</h3>
                <div class="button-left">
                    <button id="button-controll" class="UP" onmousedown="startMoving(this)" onmouseup="stopMoving(this)" ontouchstart="startMoving(this)" ontouchend="stopMoving(this)"></button>
                </div>
                <div class="button-top">
                    <button id="button-controll1" class="LEFT" onmousedown="startMoving(this)" onmouseup="stopMoving(this)" ontouchstart="startMoving(this)" ontouchend="stopMoving(this)"></button>
                    <button id="button-controll2" class="DOWN" onmousedown="startMoving(this)" onmouseup="stopMoving(this)" ontouchstart="startMoving(this)" ontouchend="stopMoving(this)"></button>
                    <button id="button-controll3" class="RIGHT" onmousedown="startMoving(this)" onmouseup="stopMoving(this)" ontouchstart="startMoving(this)" ontouchend="stopMoving(this)"></button>
                </div>
            </div>
            <div class="settings-controlls">
                <h3>Settings:</h3>
                <div class="lineFolowerContainer">
                     <p class="settings-p">Line Follower: </p>
                     <input type="checkbox" id="lineFollower" name="lineFolowerCheckBox">
                </div>
                <div class="lineFolowerContainer">
                     <p class="settings-p">Suicide Prevention: </p>
                     <input type="checkbox" id="suicidePrev" name="SuicidePrevCheckBox">
                </div>
            </div>
            <div class="mbot-connection-controlls">
                <h3>Connection:</h3>
                <div class="dropdown">
                    <button class="dropbtn">SELECT</button>
                    <div class="dropdown-content">
                      <a>ADD</a>
                      <a>MBOT: 192.11.168.1</a>
                      <a>MBOT: 192.168.168.148</a>
                      <a>MBOT: 192.168.168.148</a>
                    </div>
                  </div>
                  <button class="Connect">Connect</button>
                  <button class="Disconnect">Disconnect</button>
            </div>
        </div>
    </div>

    
    
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <script src="./scripts/login_button.js"></script>
    <script src="./scripts/connection.js"></script>
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.js"></script>
    <script type="module" src="/scripts/mbot2.js"></script>

    <script>
        function scaleUp(element) {
            element.style.transform = "scale(1.3)";
        }

        function scaleDown(element) {
                element.style.transform = "scale(1)";
        }

        // Attach event listeners to button for mouse and touch events
        document.querySelector("#button-controll").addEventListener("mouseup", function() {
            scaleDown(this);
        });
        document.querySelector("#button-controll1").addEventListener("mouseup", function() {
            scaleDown(this);
        });
        document.querySelector("#button-controll2").addEventListener("mouseup", function() {
            scaleDown(this);
        });
        document.querySelector("#button-controll3").addEventListener("mouseup", function() {
            scaleDown(this);
        });

        document.querySelector("#button-controll").addEventListener("touchend", function() {
            scaleDown(this);
        });
        document.querySelector("#button-controll1").addEventListener("touchend", function() {
            scaleDown(this);
        });
        document.querySelector("#button-controll2").addEventListener("touchend", function() {
            scaleDown(this);
        });
        document.querySelector("#button-controll3").addEventListener("touchend", function() {
            scaleDown(this);
        });

        document.querySelector("#button-controll").addEventListener("mouseleave", function() {
        scaleDown(this);
        });
        document.querySelector("#button-controll1").addEventListener("mouseleave", function() {
        scaleDown(this);
        });
        document.querySelector("#button-controll2").addEventListener("mouseleave", function() {
        scaleDown(this);
        });
        document.querySelector("#button-controll3").addEventListener("mouseleave", function() {
        scaleDown(this);
        });

    document.addEventListener('keydown', function(event) {
        // Check if the pressed key is W, A, S, or D
        switch(event.key) {
            case 'w':
            case 'W':
                // Handle the W key press
                scaleUp(document.querySelector("#button-controll"));
                break;
            case 'a':
            case 'A':
                // Handle the A key press
                scaleUp(document.querySelector("#button-controll1"));
                break;
            case 's':
            case 'S':
                // Handle the S key press
                scaleUp(document.querySelector("#button-controll2"));
                break;
            case 'd':
            case 'D':
                // Handle the D key press
                scaleUp(document.querySelector("#button-controll3"));
                break;
            default:
                // Ignore other key presses
                break;
    }
});

document.addEventListener('keyup', function(event) {
        // Check if the key is released
        switch(event.key) {
            case 'w':
            case 'W':
                // Handle the W key press
                scaleDown(document.querySelector("#button-controll"));
                break;
            case 'a':
            case 'A':
                // Handle the A key press
                scaleDown(document.querySelector("#button-controll1"));
                break;
            case 's':
            case 'S':
                // Handle the S key press
                scaleDown(document.querySelector("#button-controll2"));
                break;
            case 'd':
            case 'D':
                // Handle the D key press
                scaleDown(document.querySelector("#button-controll3"));
                break;
            default:
                // Ignore other key presses
                break;
    }
});
    </script>
</body>
</html>
